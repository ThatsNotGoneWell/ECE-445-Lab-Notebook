Credit to Joe Luo for the working Arduino code
